# Emissions

## GHG - total

```{r}
items <- c(
  "Emi|GHG", # scenario
  "Emi|GHGtot") # historical
showLinePlots(data, items)
showLinePlotsWithTarget(data, items)
```

```{r}
showLinePlots(data, "Emi|GHG|w/ Bunkers")
```


##  GHG Sectors

```{r}
items <- c(
  "Emi|GHG|Energy",
  "Emi|GHG|Industrial Processes",
  "Emi|GHG|Agriculture",
  "Emi|GHG|Waste")
walk(items, showLinePlots, data = data)
```


## GHG - Market

### ETS

```{r}
items <- "Emi|GHG|ETS"
showLinePlots(data, items)
showLinePlotsWithTarget(data, items)
```


### ESR

```{r}
items <- "Emi|GHG|ESR"
showLinePlots(data, items)
showLinePlotsWithTarget(data, items)
```

Note: Reduction targets wrt 2005


### Other - Outside ETS and ESR

```{r}
showLinePlots(data, "Emi|GHG|Outside ETS and ESR")
```


## CO2

### CO2 by sector (net emissions, incl. BECCS)

```{r}
tot <- "Emi|CO2"
items <- c(
  "Emi|CO2|Land-Use Change",
  "Emi|CO2|Industrial Processes",
  "Emi|CO2|Energy|Demand|Transport",
  "Emi|CO2|Energy|Demand|Industry",
  "Emi|CO2|Energy|Demand|Buildings",
  "Emi|CO2|Energy|Supply|Non-electric",
  "Emi|CO2|Energy|Supply|Electricity w/ couple prod",
  "Emi|CO2|CDR|DACCS",
  "Emi|CO2|CDR|EW")
showAreaAndBarPlots(data, items, tot)
```


### Total CO2

```{r}
showLinePlots(data, "Emi|CO2")
```


### Energy and Industrial Processes - Net (incl BECCS)

```{r}
items <- c(
  "Emi|CO2|Energy and Industrial Processes", # scenario
  "Emi|CO2|Fossil Fuels and Industry") # historical
showLinePlots(data, items)
```


### Energy and Industrial Processes - Gross

```{r}
items <- c(
  "Emi|CO2|Gross|Energy and Industrial Processes", # scenario
  "Emi|CO2|Fossil Fuels and Industry") # historical
showLinePlots(data, items)
```


### Energy

```{r}
showLinePlots(data, "Emi|CO2|Energy")
```


### Energy Supply

```{r}
items <- c(
  "Emi|CO2|Energy|Supply", # scenario
  "Emi|CO2|Fossil Fuels and Industry|Energy Supply") # historical
showLinePlots(data, items)
```


### Electricity

```{r}
items <- c(
  "Emi|CO2|Energy|Supply|Electricity w/ couple prod", # scenario
  "Emi|CO2|Energy|Supply|Electricity") # historical
showLinePlots(data, items)
```


### Electricity and Heat

```{r}
# UNFCCC has "EMI|CO2|Energy|Demand|Electricity and Heat",
# CEDS and REMIND only separate
# manually added for now
# TODO: move to mrremind!

item <- "Emi|CO2|Energy|Supply|Electricity and Heat"
summands <- c(
  "Emi|CO2|Energy|Supply|Electricity",
  "Emi|CO2|Energy|Supply|Heat")
newRows <-
  data %>%
  filter(variable %in% summands) %>%
  pivot_wider(names_from = variable, values_from = value) %>%
  rowwise() %>%
  mutate(!!item := sum(c_across(all_of(summands)))) %>%
  ungroup() %>%
  select(!all_of(summands)) %>%
  pivot_longer(all_of(item), names_to = "variable", values_to = "value")
showLinePlots(bind_rows(data, newRows) %>% as.quitte(), item)
```


### Buildings

```{r}
items <- c(
  "Emi|CO2|Energy|Demand|Buildings", # scenario
  "Emi|CO2|Buildings|Direct") # historical
showLinePlots(data, items)
```


### Industry

```{r}
items <- c(
  "Emi|CO2|Energy|Demand|Industry", # scenario
  "Emi|CO2|Industry|Direct") # historical
showLinePlots(data, items)
```


### Industry, Gross

```{r}
items <- c(
  "Emi|CO2|Gross|Energy|Demand|Industry", # scenario
  "Emi|CO2|Industry|Direct") # historical
showLinePlots(data, items)
```


### Industry with Industrial Processes

```{r}
# Emi|CO2|Industry = Emi|CO2|Energy|Demand|Industry + Emi|CO2|Industrial Processes
# (new REMIND reporting variable coming soon, current solution is terrible)
# TODO: Switch to new variable as soon as it is also available in historical data.
item <- "Emi|CO2|Industry"
summands <- c(
  "Emi|CO2|Energy|Demand|Industry",
  "Emi|CO2|Industrial Processes")
newRows <-
  data %>%
  filter(variable %in% summands) %>%
  pivot_wider(names_from = variable, values_from = value) %>%
  rowwise() %>%
  mutate(!!item := sum(c_across(all_of(summands)))) %>%
  ungroup() %>%
  select(!all_of(summands)) %>%
  pivot_longer(all_of(item), names_to = "variable", values_to = "value")
showLinePlots(bind_rows(data, newRows) %>% as.quitte(), item)
```


### Transport

```{r}
items <- c(
  "Emi|CO2|Energy|Demand|Transport", # scenario
  "Emi|CO2|Transport|Demand") # historical
showLinePlots(data, items)
```


### International Bunkers

```{r}
showLinePlots(data, "Emi|CO2|Energy|Demand|Transport|International Bunkers")
```


### Process Emissions

```{r}
items <- c(
  "Emi|CO2|Industrial Processes", # scenario
  "Emi|CO2|FFaI|Industry|Process") # historical
showLinePlots(data, items)
```

### Land-Use Change

```{r}
items <- c(
  "Emi|CO2|Land-Use Change", # scenario
  "Emi|CO2|Land Use") # historical
showLinePlots(data, items)
```


### non-BECCS CDR

```{r}
showLinePlots(data, "Emi|CO2|non-BECCS CDR")
```

### CDR

```{r}
tot <- "Emi|CO2"
items <- c(
  "Emi|CO2|Gross|Energy and Industrial Processes",
  "Emi|CO2|Land-Use Change",
  "Emi|CO2|CDR|BECCS",
  "Emi|CO2|CDR|Industry CCS|Synthetic Fuels",
  "Emi|CO2|CDR|DACCS",
  "Emi|CO2|CDR|EW"
)
showAreaAndBarPlots(data, items, tot)
```


```{r}
tot <- "Emi|CO2|CDR"
items <- c(
  "Emi|CO2|CDR|Land-Use Change",
  "Emi|CO2|CDR|BECCS|Pe2Se",
  "Emi|CO2|CDR|BECCS|Industry",
  "Emi|CO2|CDR|Industry CCS|Synthetic Fuels",
  "Emi|CO2|CDR|DACCS",
  "Emi|CO2|CDR|EW"
)
showAreaAndBarPlots(data, items, tot)
```


```{r}
cdrVars <-
  levels(data$variable) %>%
  str_subset(fixed("Emi|CO2|CDR|"))
walk(cdrVars, showLinePlots, data = data)
```


### Cumulated Emissions

```{r}
d <-
  data %>%
  filter(variable == "Emi|CO2|Cumulated")
# subtract 2010 values
d <-
  d %>%
  left_join(
    d %>% filter(period == 2010),
    by = c("model", "scenario", "region", "variable"),
    suffix = c("", "2010")) %>%
  mutate(value = value - value2010)
showLinePlots(d)
```


```{r}
cdrVars <-
  levels(data$variable) %>%
  str_subset(fixed("Emi|CO2|Cumulated|CDR|"))
walk(cdrVars, showLinePlots, data = data)
```

```{r}
tot <- "Emi|CO2|Cumulated"
items <- c(
  "Emi|CO2|Cumulated|Gross|Energy and Industrial Processes",
  "Emi|CO2|Cumulated|Land-Use Change",
  "Emi|CO2|Cumulated|CDR|BECCS|Pe2Se",
  "Emi|CO2|Cumulated|CDR|BECCS|Industry",
  "Emi|CO2|Cumulated|CDR|Industry CCS|Synthetic Fuels",
  "Emi|CO2|Cumulated|CDR|DACCS",
  "Emi|CO2|Cumulated|CDR|EW")
showAreaAndBarPlots(data, items, tot)
```

## Market Emissions

### GHG ETS Emissions

```{r}
tot <- "Emi|GHG|ETS"
items <- c(
  "Emi|GHG|ETS|Energy Supply",
  "Emi|GHG|ETS|Industry",
  "Emi|GHG|ETS|Transport",
  "Emi|GHG|ETS|Extraction",
  "Emi|GHG|ETS|Waste",
  "Emi|GHG|ETS|non-BECCS CDR")
showAreaAndBarPlots(data, items, tot)
```

### GHG ESR Emissions

```{r}
tot <- "Emi|GHG|ESR"
items <- c(
  "Emi|GHG|ESR|Buildings",
  "Emi|GHG|ESR|Industry",
  "Emi|GHG|ESR|Transport",
  "Emi|GHG|ESR|Agriculture",
  "Emi|GHG|ESR|Waste")
showAreaAndBarPlots(data, items, tot)
```

### GHG Other Emissions - Outisde ETS and ESR

```{r}
tot <- "Emi|GHG|Outside ETS and ESR"
items <- c(
  "Emi|GHG|Outside ETS and ESR|Transport",
  "Emi|GHG|Outside ETS and ESR|Land-Use Change",
  "Emi|GHG|Outside ETS and ESR|F-Gases")
showAreaAndBarPlots(data, items, tot)
```

### Market Emissions across GHGs

```{r}
showLinePlots(data, "Emi|CO2|ETS")
showLinePlots(data, "Emi|CO2|ESR")
showLinePlots(data, "Emi|CO2|Outside ETS and ESR")
```

### Market CH4

```{r}
showLinePlots(data, "Emi|CH4|ETS")
showLinePlots(data, "Emi|CH4|ESR")
showLinePlots(data, "Emi|CH4|Outside ETS and ESR")
```

### Market N2O

```{r}
showLinePlots(data, "Emi|N2O|ETS")
showLinePlots(data, "Emi|N2O|ESR")
showLinePlots(data, "Emi|N2O|Outside ETS and ESR")
```


## CH4

```{r}
tot <- "Emi|CH4"
items <- c(
  "Emi|CH4|Extraction",
  "Emi|CH4|Agriculture",
  "Emi|CH4|Land-Use Change",
  "Emi|CH4|Waste",
  "Emi|CH4|Energy Supply")
showAreaAndBarPlots(data, items, tot)
```

## N2O

```{r}
tot <- "Emi|N2O"
items <- c(
  "Emi|N2O|Agriculture",
  "Emi|N2O|Land-Use Change",
  "Emi|N2O|Waste",
  "Emi|N2O|Transport",
  "Emi|N2O|Industry",
  "Emi|N2O|Energy Supply")
showAreaAndBarPlots(data, items, tot)
```

### F-Gases

```{r}
showLinePlots(data, "Emi|GHG|F-Gases")
```

## Industry Subsector Emissions

```{r}
items <- c(
  "Emi|CO2|Energy|Demand|Industry|Steel",
  "Emi|CO2|Energy|Demand|Industry|Cement",
  "Emi|CO2|Energy|Demand|Industry|Chemicals",
  "Emi|CO2|Energy|Demand|Industry|Other Industry")
showAreaAndBarPlots(data, items)
walk(items, showLinePlots, data = data)
```
